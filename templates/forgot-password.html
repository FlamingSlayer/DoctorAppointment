<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reset Password - MediCare</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <style>
    @import url('/static/css/login.css');
    
    /* Small extra style for the success message animation */
    .success-message {
        text-align: center;
        display: none;
        padding: 20px 0;
        animation: fadeIn 0.5s ease;
    }
    .success-icon {
        font-size: 3.5rem;
        color: #10B981;
        margin-bottom: 1rem;
    }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body>

  <button class="theme-toggle" id="themeToggle" title="Toggle theme">
    <i class="fas fa-moon"></i>
  </button>

  <a href="login.html" class="back-btn">
    <i class="fas fa-arrow-left"></i>
    Back to Login
  </a>

  <div class="container">
    <div class="login-card">
      
      <div class="card-header">
        <div class="logo">
          <div class="logo-icon">
            <i class="fas fa-heart-pulse"></i>
          </div>
          <span class="logo-text">MediCare</span>
        </div>
        <h1 class="welcome-title">Reset Password</h1>
        <p class="welcome-subtitle">Enter your email to receive reset instructions</p>
      </div>

      <div class="card-body">
        
        <div id="success-view" class="success-message">
            <div class="success-icon">
                <i class="fas fa-envelope-open-text"></i>
            </div>
            <h3 style="margin-bottom: 10px; color: var(--text-main);">Check your Inbox</h3>
            <p style="color: var(--text-muted); margin-bottom: 20px;">
                We have sent a password reset link to <br>
                <strong id="user-email" style="color: var(--primary)"></strong>
            </p>
            <a href="login.html" class="btn btn-primary" style="text-decoration: none;">
                Return to Sign In
            </a>
        </div>

        <form id="reset-form" onsubmit="handleReset(event)">
          <div class="form-group">
            <label class="form-label" for="email">Email Address</label>
            <input type="email" id="email" class="form-input" placeholder="Enter your registered email" required>
            <small class="form-hint">We will send a code to this email.</small>
          </div>
          
          <button type="submit" class="btn btn-primary" id="submitBtn">
            <span id="btn-text">Send Reset Link</span>
            <span id="btn-spinner" class="hidden">
              <span class="spinner"></span> Sending...
            </span>
          </button>
        </form>

      </div>
    </div>
  </div>

  <div class="toast-container" id="toast-container"></div>

  <script>
    // --- 1. THEME MANAGEMENT (Matches Login Page) ---
    const themeToggle = document.getElementById('themeToggle');
    const themeIcon = themeToggle.querySelector('i');
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)');
    const savedTheme = localStorage.getItem('theme');
    
    function setTheme(theme) {
      document.documentElement.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);
      if (theme === 'dark') {
        themeIcon.className = 'fas fa-sun';
        themeToggle.title = 'Switch to light theme';
      } else {
        themeIcon.className = 'fas fa-moon';
        themeToggle.title = 'Switch to dark theme';
      }
    }
    
    if (savedTheme) setTheme(savedTheme);
    else if (prefersDark.matches) setTheme('dark');
    else setTheme('light');
    
    themeToggle.addEventListener('click', () => {
      const current = document.documentElement.getAttribute('data-theme');
      setTheme(current === 'dark' ? 'light' : 'dark');
    });

    // --- 2. RESET LOGIC ---
    async function handleReset(e) {
        e.preventDefault();
        
        const email = document.getElementById('email').value;
        const btn = document.getElementById('submitBtn');
        const text = document.getElementById('btn-text');
        const spinner = document.getElementById('btn-spinner');
        const form = document.getElementById('reset-form');
        const successView = document.getElementById('success-view');
        const headerSubtitle = document.querySelector('.welcome-subtitle');

        // Loading State
        btn.disabled = true;
        btn.classList.add('btn-loading');
        text.classList.add('hidden');
        spinner.classList.remove('hidden');

        // Simulate Network Request (1.5 seconds)
        await new Promise(r => setTimeout(r, 1500));

        // Show Success View
        document.getElementById('user-email').textContent = email;
        
        // Hide Form Elements
        form.style.display = 'none';
        headerSubtitle.style.display = 'none'; // Hide the "Enter email..." text
        
        // Show Success Message
        successView.style.display = 'block';
    }
  </script>
</body>
</html>